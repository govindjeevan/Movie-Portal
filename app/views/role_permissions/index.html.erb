<h1>Assign Permissions to Roles</h1>
<hr>
<table class="responsive nowrap table table-hover" id="dttb-role_permissions" data-sort="true" data-source="<%= url_for(format: :json) %>">
  <thead>
  <tr>
    <th data-data="role_id">Role</th>
    <th data-data="permission_id">Permission</th>
    <th data-data="actions">Actions</th>

  </tr>
  </thead>

  <tbody>

  <% @role_permissions.each do |rp| %>
    <tr>
      <% role= @roles.select{ |m| m.id == rp.role_id  }.first %>
      <% permission= @permissions.select{ |m| m.id == rp.permission_id}.first %>
      <td><%= role.name.capitalize %></td>
      <td><%= permission.description %> [ <%= permission.actions %> in <%= permission.subject_class %> ]</td>

      <% if  can? :update, RolePermission  %>
        <td>
          <%= link_to 'Edit', edit_role_permission_path(rp), :class => "btn btn-warning" %>
          <% if can? :destroy, RolePermission %>
            <%= link_to 'Destroy', rp, method: :delete, data: {confirm: 'Are you sure?'}, :class => "btn btn-danger" %></td>
          <% end %>
      <% end %>


    </tr>
  <% end %>
  </tbody>


</table>

<br>

<%= link_to 'New Role Permission', new_role_permission_path, :class => "btn btn-primary" %>